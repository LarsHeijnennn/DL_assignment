<?xml version="1.0" encoding="UTF-8"?>
<svg width="1600" height="600" xmlns="http://www.w3.org/2000/svg">
  <!-- Background -->
  <rect width="1600" height="600" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="700" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#2c3e50">
    Accent Classification Pipeline with CNN Variants
  </text>
  
  <!-- Legend -->
  <g id="legend" transform="translate(50, 50)">
    <rect x="0" y="0" width="300" height="120" fill="white" stroke="#ddd" stroke-width="1" rx="5"/>
    <text x="10" y="20" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#2c3e50">Legend:</text>
    
    <ellipse cx="25" cy="40" rx="15" ry="8" fill="#27ae60" stroke="#1e8449" stroke-width="2"/>
    <text x="50" y="45" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Input/Output</text>
    
    <rect x="10" y="55" width="30" height="15" fill="#f39c12" stroke="#d68910" stroke-width="2"/>
    <text x="50" y="67" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Preprocessing</text>
    
    <rect x="10" y="75" width="30" height="15" fill="#3498db" stroke="#2980b9" stroke-width="2"/>
    <text x="50" y="87" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Training</text>
    
    <rect x="10" y="95" width="30" height="15" fill="#9b59b6" stroke="#8e44ad" stroke-width="2"/>
    <text x="50" y="107" font-family="Arial, sans-serif" font-size="12" fill="#2c3e50">Evaluation</text>
  </g>
  
  <!-- Pipeline Components -->
  
  <!-- 1. Input: Raw Audio Files -->
  <g id="input-audio" transform="translate(50, 220)">
    <ellipse cx="80" cy="40" rx="70" ry="30" fill="#27ae60" stroke="#1e8449" stroke-width="3"/>
    <text x="80" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Raw Audio Files</text>
    <text x="80" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">.wav files</text>
    
    <!-- Details box -->
    <rect x="10" y="85" width="140" height="60" fill="white" stroke="#27ae60" stroke-width="1" rx="3"/>
    <text x="80" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#2c3e50">3,166 samples</text>
    <text x="80" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#2c3e50">Format: {accent}{gender}.wav</text>
    <text x="80" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#2c3e50">Accents: 0-4, Gender: m/f</text>
  </g>
  
  <!-- Arrow 1 -->
  <path d="M 210 260 L 250 260" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- 2. Data Loading -->
  <g id="data-loading" transform="translate(270, 220)">
    <rect x="0" y="10" width="120" height="60" fill="#f39c12" stroke="#d68910" stroke-width="3" rx="5"/>
    <text x="60" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Data Loading</text>
    <text x="60" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">torchaudio.load()</text>
    
    <!-- Details box -->
    <rect x="10" y="85" width="100" height="45" fill="white" stroke="#f39c12" stroke-width="1" rx="3"/>
    <text x="60" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#2c3e50">Resample to</text>
    <text x="60" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#2c3e50">16,000 Hz</text>
  </g>
  
  <!-- Arrow 2 -->
  <path d="M 410 250 L 450 250" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- 3. Dataset Creation -->
  <g id="dataset-creation" transform="translate(470, 200)">
    <rect x="0" y="10" width="140" height="80" fill="#f39c12" stroke="#d68910" stroke-width="3" rx="5"/>
    <text x="70" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Dataset Creation</text>
    <text x="70" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">AccentSpectrogramDataset</text>
    <text x="70" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Mel-spectrogram</text>
    <text x="70" y="75" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">n_mels=64</text>
    
    <!-- Details box -->
    <rect x="10" y="105" width="120" height="75" fill="white" stroke="#f39c12" stroke-width="1" rx="3"/>
    <text x="70" y="120" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">n_fft=400, hop_length=200</text>
    <text x="70" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">log_scale=True</text>
    <text x="70" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Extract labels from filenames</text>
    <text x="70" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Total: 3,166 samples</text>
  </g>
  
  <!-- Arrow 3 -->
  <path d="M 630 250 L 670 250" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- 4. DataLoader with Padding -->
  <g id="dataloader" transform="translate(690, 220)">
    <rect x="0" y="10" width="120" height="60" fill="#f39c12" stroke="#d68910" stroke-width="3" rx="5"/>
    <text x="60" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">DataLoader</text>
    <text x="60" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">with Padding</text>
    <text x="60" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">pad_collate</text>
    
    <!-- Details box -->
    <rect x="10" y="85" width="100" height="90" fill="white" stroke="#f39c12" stroke-width="1" rx="3"/>
    <text x="60" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Batch size: 4</text>
    <text x="60" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Fixed width: 208</text>
    <text x="60" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Train: 2,532 (80%)</text>
    <text x="60" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Test: 634 (20%)</text>
    <text x="60" y="160" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Seed: 42</text>
  </g>
  
  <!-- Arrow 4 -->
  <path d="M 830 250 L 870 250" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- 5. Model Training (with branches) -->
  <g id="model-training" transform="translate(890, 120)">
    <rect x="0" y="110" width="160" height="80" fill="#3498db" stroke="#2980b9" stroke-width="3" rx="5"/>
    <text x="80" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Model Training</text>
    <text x="80" y="150" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">6 CNN Variants</text>
    <text x="80" y="165" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Early Stopping</text>
    <text x="80" y="180" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Max epochs: 150</text>
    
    <!-- CNN Variants (branching) -->
    <g id="cnn-variants">
      <!-- Baseline -->
      <rect x="180" y="20" width="80" height="30" fill="#85c1e9" stroke="#5dade2" stroke-width="1" rx="3"/>
      <text x="220" y="38" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">CNNBaseline</text>
      
      <!-- BatchNorm -->
      <rect x="180" y="55" width="80" height="30" fill="#85c1e9" stroke="#5dade2" stroke-width="1" rx="3"/>
      <text x="220" y="68" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">CNNBaseline_</text>
      <text x="220" y="78" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">BatchNorm</text>
      
      <!-- Dropout3 -->
      <rect x="180" y="90" width="80" height="30" fill="#85c1e9" stroke="#5dade2" stroke-width="1" rx="3"/>
      <text x="220" y="103" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">CNNBaseline_</text>
      <text x="220" y="113" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">Dropout3</text>
      
      <!-- Dropout5 -->
      <rect x="180" y="125" width="80" height="30" fill="#85c1e9" stroke="#5dade2" stroke-width="1" rx="3"/>
      <text x="220" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">CNNBaseline_</text>
      <text x="220" y="148" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">Dropout5</text>
      
      <!-- Dropout3_BatchNorm -->
      <rect x="180" y="160" width="80" height="30" fill="#85c1e9" stroke="#5dade2" stroke-width="1" rx="3"/>
      <text x="220" y="170" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#2c3e50">CNNBaseline_Dropout3_</text>
      <text x="220" y="182" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#2c3e50">BatchNorm</text>
      
      <!-- Dropout5_BatchNorm -->
      <rect x="180" y="195" width="80" height="30" fill="#85c1e9" stroke="#5dade2" stroke-width="1" rx="3"/>
      <text x="220" y="205" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#2c3e50">CNNBaseline_Dropout5_</text>
      <text x="220" y="217" text-anchor="middle" font-family="Arial, sans-serif" font-size="6" fill="#2c3e50">BatchNorm</text>
      
      <!-- Branching lines -->
      <path d="M 160 150 L 180 35" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 160 150 L 180 70" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 160 150 L 180 105" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 160 150 L 180 140" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 160 150 L 180 175" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 160 150 L 180 210" stroke="#2980b9" stroke-width="1" fill="none"/>
      
      <!-- Converging lines -->
      <path d="M 260 35 L 280 150" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 260 70 L 280 150" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 260 105 L 280 150" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 260 140 L 280 150" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 260 175 L 280 150" stroke="#2980b9" stroke-width="1" fill="none"/>
      <path d="M 260 210 L 280 150" stroke="#2980b9" stroke-width="1" fill="none"/>
    </g>
    
    <!-- Architecture details -->
    <rect x="10" y="210" width="140" height="120" fill="white" stroke="#3498db" stroke-width="1" rx="3"/>
    <text x="80" y="225" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" font-weight="bold" fill="#2c3e50">Architecture:</text>
    <text x="80" y="240" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">3 Conv2d layers (8→16→32)</text>
    <text x="80" y="253" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">Kernel: 3×3, Padding: 1</text>
    <text x="80" y="266" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">ReLU activation</text>
    <text x="80" y="279" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">AdaptiveAvgPool2d (16×16)</text>
    <text x="80" y="292" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">Linear output layer</text>
    <text x="80" y="305" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">Adam optimizer (lr=0.001)</text>
    <text x="80" y="318" text-anchor="middle" font-family="Arial, sans-serif" font-size="7" fill="#2c3e50">CrossEntropyLoss</text>
  </g>
  
  <!-- Arrow 5 -->
  <path d="M 1170 270 L 1210 270" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- 6. Model Evaluation -->
  <g id="model-evaluation" transform="translate(1230, 220)">
    <rect x="0" y="10" width="120" height="60" fill="#9b59b6" stroke="#8e44ad" stroke-width="3" rx="5"/>
    <text x="60" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="white">Model Evaluation</text>
    <text x="60" y="45" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Test Data</text>
    <text x="60" y="60" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="white">Metrics</text>
    
    <!-- Details box -->
    <rect x="10" y="85" width="100" height="75" fill="white" stroke="#9b59b6" stroke-width="1" rx="3"/>
    <text x="60" y="100" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Accuracy, Precision</text>
    <text x="60" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Recall, F1-score</text>
    <text x="60" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Gender-specific</text>
    <text x="60" y="145" text-anchor="middle" font-family="Arial, sans-serif" font-size="8" fill="#2c3e50">Classification reports</text>
  </g>
  
  <!-- Arrow 6 -->
  <path d="M 1350 250 L 1390 250" stroke="#2c3e50" stroke-width="2" fill="none" marker-end="url(#arrowhead)"/>
  
  <!-- 7. Output: Predictions and Metrics -->
  <g id="output" transform="translate(1410, 220)">
    <ellipse cx="80" cy="40" rx="70" ry="30" fill="#27ae60" stroke="#1e8449" stroke-width="3"/>
    <text x="80" y="35" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">Predictions</text>
    <text x="80" y="50" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="white">Metrics</text>
  </g>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
    <marker id="arrowhead-dashed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#d68910"/>
    </marker>
  </defs>
</svg>
